const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/MapContainer-By3dLU-a.js","assets/index-TZVx3gCu.js","assets/index-x25ocZ2C.css","assets/card-a9jYFsrW.js","assets/MapContainer-Dgihpmma.css","assets/PollutionDashboard-CRMUbXfr.js","assets/DataFilterPanel-Ba1sOmlW.js"])))=>i.map(i=>d[i]);
import{c as p,r as n,j as e,a as I,t as j,B as u,L as D,_ as k}from"./index-TZVx3gCu.js";/**
 * @license lucide-react v0.394.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const T=p("BarChart3",[["path",{d:"M3 3v18h18",key:"1s2lah"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]]);/**
 * @license lucide-react v0.394.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const P=p("CircleAlert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);/**
 * @license lucide-react v0.394.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $=p("CircleCheckBig",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);/**
 * @license lucide-react v0.394.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const A=p("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]);/**
 * @license lucide-react v0.394.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const V=p("Filter",[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]]);/**
 * @license lucide-react v0.394.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const H=p("MapPin",[["path",{d:"M20 10c0 6-8 12-8 12s-8-6-8-12a8 8 0 0 1 16 0Z",key:"2oe9fu"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]]);/**
 * @license lucide-react v0.394.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const B=p("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.394.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const M=p("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]),L=n.forwardRef(({className:a,type:d,...l},s)=>e.jsx("input",{type:d,className:I("flex h-9 w-full rounded-md border border-input bg-transparent px-3 py-1 text-sm shadow-sm transition-colors file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50",a),ref:s,...l}));L.displayName="Input";const U=a=>{const l=a.trim().split(`
`).slice(1),s=[];return l.forEach((i,m)=>{try{const c=W(i);if(c.length>=8){const x={station_id:c[0],station_name:c[1],lat:parseFloat(c[2]),lon:parseFloat(c[3]),sample_dt:c[4],pol_a:parseFloat(c[5]),pol_b:parseFloat(c[6]),unit:c[7]};!isNaN(x.lat)&&!isNaN(x.lon)&&!isNaN(x.pol_a)&&!isNaN(x.pol_b)?s.push(x):console.warn(`Skipping invalid data at line ${m+2}:`,i)}else console.warn(`Insufficient columns at line ${m+2}:`,i)}catch(c){console.error(`Error parsing line ${m+2}:`,c)}}),s},W=a=>{const d=[];let l="",s=!1;for(let i=0;i<a.length;i++){const m=a[i];m==='"'?s=!s:m===","&&!s?(d.push(l.trim()),l=""):l+=m}return d.push(l.trim()),d.map(i=>i.replace(/^"(.*)"$/,"$1"))},q=a=>new Promise((d,l)=>{const s=new FileReader;s.onload=i=>{var m;try{const c=(m=i.target)==null?void 0:m.result,x=U(c);d(x)}catch(c){l(c)}},s.onerror=()=>{l(new Error("Failed to read file"))},s.readAsText(a)}),G=a=>[["station_id","station_name","lat","lon","sample_dt","pol_a","pol_b","unit"].join(","),...a.map(s=>[`"${s.station_id}"`,`"${s.station_name}"`,s.lat.toString(),s.lon.toString(),`"${s.sample_dt}"`,s.pol_a.toString(),s.pol_b.toString(),`"${s.unit}"`].join(","))].join(`
`),Q=(a,d="pollution_data.csv")=>{const l=G(a),s=new Blob([l],{type:"text/csv;charset=utf-8;"}),i=document.createElement("a");if(i.download!==void 0){const m=URL.createObjectURL(s);i.setAttribute("href",m),i.setAttribute("download",d),i.style.visibility="hidden",document.body.appendChild(i),i.click(),document.body.removeChild(i)}},Z=n.lazy(()=>k(()=>import("./MapContainer-By3dLU-a.js"),__vite__mapDeps([0,1,2,3,4]))),J=n.lazy(()=>k(()=>import("./PollutionDashboard-CRMUbXfr.js"),__vite__mapDeps([5,1,2]))),K=n.lazy(()=>k(()=>import("./DataFilterPanel-Ba1sOmlW.js"),__vite__mapDeps([6,1,2,3]))),X={stationQuery:"",dateFrom:null,dateTo:null,polAMin:0,polBMin:0},Y={showStations:!0,showHeatmap:!0,heatmapOpacity:.7,heatmapRadius:25,enableStationClustering:!1,enableRecordClustering:!1,showRecordCount:!1},S=({message:a="Loading..."})=>e.jsxs("div",{className:"flex items-center justify-center p-8",children:[e.jsx(D,{className:"w-6 h-6 animate-spin text-blue-600 mr-3"}),e.jsx("span",{className:"text-sm text-gray-600",children:a})]}),ee=n.memo(({stationCount:a,recordCount:d,onMenuToggle:l,isMenuOpen:s})=>e.jsx("header",{className:"bg-white border-b border-gray-200 shadow-sm sticky top-0 z-30",children:e.jsx("div",{className:"px-6 py-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(u,{variant:"ghost",size:"sm",onClick:l,className:"lg:hidden","aria-label":s?"Close menu":"Open menu",children:e.jsxs("div",{className:"w-5 h-5 flex flex-col justify-center gap-1",children:[e.jsx("div",{className:`h-0.5 bg-current transition-all ${s?"rotate-45 translate-y-1.5":""}`}),e.jsx("div",{className:`h-0.5 bg-current transition-all ${s?"opacity-0":""}`}),e.jsx("div",{className:`h-0.5 bg-current transition-all ${s?"-rotate-45 -translate-y-1.5":""}`})]})}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-gradient-to-r from-blue-600 to-indigo-600 rounded-xl flex items-center justify-center",children:e.jsx(H,{className:"w-5 h-5 text-white"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-lg font-semibold text-gray-900",children:"WebGIS Platform"}),e.jsx("p",{className:"text-xs text-gray-600",children:"Environmental Data Visualization"})]})]})]}),e.jsx("div",{className:"hidden sm:flex items-center gap-6",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-sm font-semibold text-blue-600",children:a}),e.jsx("div",{className:"text-xs text-gray-500",children:"Stations"})]}),e.jsx("div",{className:"w-px h-8 bg-gray-300"}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-sm font-semibold text-emerald-600",children:d.toLocaleString()}),e.jsx("div",{className:"text-xs text-gray-500",children:"Records"})]})]})})]})})})),te=n.memo(({isOpen:a,onClose:d,children:l})=>e.jsxs(e.Fragment,{children:[a&&e.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm z-40 lg:hidden",onClick:d,"aria-hidden":"true"}),e.jsx("aside",{className:`
      fixed top-0 left-0 h-full w-96 bg-white border-r border-gray-200 shadow-xl z-50
      transform transition-transform duration-300 ease-in-out
      ${a?"translate-x-0":"-translate-x-full"}
      lg:translate-x-0 lg:static lg:shadow-none
    `,children:e.jsxs("div",{className:"h-full flex flex-col",children:[e.jsx("div",{className:"p-6 border-b border-gray-200 bg-gradient-to-r from-blue-50 to-indigo-50",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Control Panel"}),e.jsx(u,{variant:"ghost",size:"sm",onClick:d,className:"lg:hidden","aria-label":"Close sidebar",children:"Ã—"})]})}),e.jsx("div",{className:"flex-1 overflow-y-auto",children:l})]})})]})),se=()=>{const[a,d]=n.useState([]),[l,s]=n.useState([]),[i,m]=n.useState(!1),[c,x]=n.useState(null),[h,O]=n.useState(X),[r,f]=n.useState(Y),[w,_]=n.useState(!1),[C,E]=n.useState("data"),v=n.useRef(null),y=n.useMemo(()=>{var t;return{totalStations:new Set(a.map(o=>o.station_id)).size,totalRecords:a.length,filteredRecords:l.length,lastUpdated:a.length>0?(t=a[0])==null?void 0:t.sample_dt:void 0}},[a,l]);n.useEffect(()=>{let t=a;if(h.stationQuery){const o=h.stationQuery.toLowerCase();t=t.filter(b=>b.station_name.toLowerCase().includes(o))}h.dateFrom&&(t=t.filter(o=>o.sample_dt>=h.dateFrom)),h.dateTo&&(t=t.filter(o=>o.sample_dt<=h.dateTo)),h.polAMin>0&&(t=t.filter(o=>o.pol_a>=h.polAMin)),h.polBMin>0&&(t=t.filter(o=>o.pol_b>=h.polBMin)),s(t)},[a,h]);const R=n.useCallback(async t=>{var b;const o=(b=t.target.files)==null?void 0:b[0];if(o){if(!o.name.toLowerCase().endsWith(".csv")){j.error("Please select a CSV file");return}m(!0),x(null);try{const g=await q(o);d(g),x(null),j.success(`Successfully imported ${g.length} station records from ${new Set(g.map(N=>N.station_id)).size} stations`)}catch(g){const N=g instanceof Error?g.message:"Failed to import CSV file";x(N),j.error(N)}finally{m(!1),v.current&&(v.current.value="")}}},[]),F=n.useCallback(()=>{if(l.length===0){j.error("No data to export");return}try{Q(l,`pollution_data_filtered_${new Date().toISOString().split("T")[0]}.csv`),j.success(`Exported ${l.length} records successfully`)}catch{j.error("Failed to export data")}},[l]);n.useCallback(()=>{const t=typeof window<"u"&&window.innerWidth>=768&&window.innerWidth<1024;return typeof window<"u"&&window.innerWidth<768?{top:60,left:16,right:16,bottom:120}:t?{top:70,left:32,right:32,bottom:100}:{top:80,left:400,right:16,bottom:90}},[]);const z=n.useCallback(()=>{switch(C){case"data":return e.jsx("div",{className:"p-6 space-y-6",children:e.jsxs("div",{children:[e.jsx("h3",{className:"text-base font-semibold mb-4",children:"Data Management"}),e.jsxs("div",{className:"space-y-4",children:[e.jsx(L,{ref:v,type:"file",accept:".csv",onChange:R,disabled:i,className:"hidden",id:"csv-upload"}),e.jsx(u,{onClick:()=>{var t;return(t=v.current)==null?void 0:t.click()},disabled:i,className:"w-full",children:i?e.jsxs(e.Fragment,{children:[e.jsx(D,{className:"w-4 h-4 mr-2 animate-spin"}),"Importing..."]}):e.jsxs(e.Fragment,{children:[e.jsx(M,{className:"w-4 h-4 mr-2"}),"Import CSV Data"]})}),e.jsxs(u,{onClick:F,disabled:l.length===0,variant:"outline",className:"w-full",children:[e.jsx(A,{className:"w-4 h-4 mr-2"}),"Export Filtered Data"]})]}),e.jsxs("div",{className:"bg-gray-50 rounded-lg p-4 mt-6",children:[e.jsx("h4",{className:"text-sm font-medium mb-3",children:"Statistics"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-base font-semibold text-blue-600",children:y.totalRecords.toLocaleString()}),e.jsx("div",{className:"text-xs text-gray-500",children:"Total Records"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-base font-semibold text-emerald-600",children:y.filteredRecords.toLocaleString()}),e.jsx("div",{className:"text-xs text-gray-500",children:"Filtered"})]})]})]}),a.length>0&&!c&&e.jsx("div",{className:"bg-emerald-50 border border-emerald-200 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx($,{className:"w-5 h-5 text-emerald-600 mt-0.5 flex-shrink-0"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-emerald-800 font-medium",children:"Data loaded successfully!"}),e.jsx("p",{className:"text-xs text-emerald-700 mt-1",children:"Check the map and dashboard for visualizations."})]})]})}),c&&e.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(P,{className:"w-5 h-5 text-red-600 mt-0.5 flex-shrink-0"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-red-800 font-medium",children:"Import Error"}),e.jsx("p",{className:"text-xs text-red-700 mt-1",children:c})]})]})})]})});case"dashboard":return e.jsxs("div",{className:"p-6",children:[e.jsx("h3",{className:"text-base font-semibold mb-4",children:"Analytics Dashboard"}),e.jsx(n.Suspense,{fallback:e.jsx(S,{message:"Loading dashboard..."}),children:e.jsx(J,{stationData:l})})]});case"filters":return e.jsxs("div",{className:"p-6",children:[e.jsx("h3",{className:"text-base font-semibold mb-4",children:"Data Filters"}),e.jsx(n.Suspense,{fallback:e.jsx(S,{message:"Loading filters..."}),children:e.jsx(K,{value:h,onChange:O})})]});case"settings":return e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsx("h3",{className:"text-base font-semibold mb-4",children:"Map Settings"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm",children:"Station Markers"}),e.jsx(u,{variant:r.showStations?"default":"outline",size:"sm",onClick:()=>f(t=>({...t,showStations:!t.showStations})),children:r.showStations?"ON":"OFF"})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm",children:"Heatmap"}),e.jsx(u,{variant:r.showHeatmap?"default":"outline",size:"sm",onClick:()=>f(t=>({...t,showHeatmap:!t.showHeatmap})),children:r.showHeatmap?"ON":"OFF"})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm",children:"Station Clustering"}),e.jsx(u,{variant:r.enableStationClustering?"default":"outline",size:"sm",onClick:()=>f(t=>({...t,enableStationClustering:!t.enableStationClustering})),children:r.enableStationClustering?"ON":"OFF"})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm",children:"Record Clustering"}),e.jsx(u,{variant:r.enableRecordClustering?"default":"outline",size:"sm",onClick:()=>f(t=>({...t,enableRecordClustering:!t.enableRecordClustering})),children:r.enableRecordClustering?"ON":"OFF"})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm",children:"Record Count"}),e.jsx(u,{variant:r.showRecordCount?"default":"outline",size:"sm",onClick:()=>f(t=>({...t,showRecordCount:!t.showRecordCount})),children:r.showRecordCount?"ON":"OFF"})]})]}),r.showHeatmap&&e.jsxs("div",{className:"space-y-4 pt-4 border-t border-gray-200",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"text-sm font-medium block mb-2",children:["Opacity: ",Math.round(r.heatmapOpacity*100),"%"]}),e.jsx("input",{type:"range",min:"0",max:"1",step:"0.1",value:r.heatmapOpacity,onChange:t=>f(o=>({...o,heatmapOpacity:parseFloat(t.target.value)})),className:"w-full"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"text-sm font-medium block mb-2",children:["Radius: ",r.heatmapRadius,"px"]}),e.jsx("input",{type:"range",min:"10",max:"50",step:"5",value:r.heatmapRadius,onChange:t=>f(o=>({...o,heatmapRadius:parseInt(t.target.value)})),className:"w-full"})]})]})]});default:return null}},[C,i,l,y,a.length,c,r,h,R,F]);return e.jsxs("div",{className:"min-h-screen bg-gray-50",children:[e.jsx(ee,{stationCount:y.totalStations,recordCount:y.totalRecords,onMenuToggle:()=>_(!w),isMenuOpen:w}),e.jsxs("div",{className:"flex h-[calc(100vh-80px)]",children:[e.jsxs(te,{isOpen:w,onClose:()=>_(!1),children:[e.jsx("div",{className:"border-b border-gray-200 bg-white",children:e.jsx("nav",{className:"flex",children:[{id:"data",label:"Data",icon:M},{id:"dashboard",label:"Dashboard",icon:T},{id:"filters",label:"Filters",icon:V},{id:"settings",label:"Settings",icon:B}].map(({id:t,label:o,icon:b})=>e.jsxs("button",{onClick:()=>E(t),className:`
                    flex-1 flex items-center justify-center gap-2 py-3 px-2 text-xs font-medium
                    border-b-2 transition-colors
                    ${C===t?"border-blue-600 text-blue-600 bg-blue-50":"border-transparent text-gray-500 hover:text-gray-700 hover:bg-gray-50"}
                  `,children:[e.jsx(b,{className:"w-4 h-4"}),e.jsx("span",{className:"hidden sm:inline",children:o})]},t))})}),z()]}),e.jsx("main",{className:"flex-1 relative",children:e.jsx(n.Suspense,{fallback:e.jsx(S,{message:"Loading map..."}),children:e.jsx(Z,{stationData:l,showStationMarkers:r.showStations,showHeatmap:r.showHeatmap,heatmapOpacity:r.heatmapOpacity,heatmapRadius:r.heatmapRadius,enableStationClustering:r.enableStationClustering,enableRecordClustering:r.enableRecordClustering,showRecordCount:r.showRecordCount})})})]})]})},ae=n.memo(se),ne=Object.freeze(Object.defineProperty({__proto__:null,default:ae},Symbol.toStringTag,{value:"Module"}));export{T as B,L as I,H as M,ne as P};
